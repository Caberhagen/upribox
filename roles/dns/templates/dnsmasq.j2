# Configuration file for dnsmasq with upribox DNS request filtering and Tor as a resolver.
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
#     see https://upribox.readthedocs.io/en/latest/intro.html#customization

# Never forward addresses in the non-routed address spaces.
bogus-priv

# Change this line if you want dns to get its upstream servers from
# somewhere other that /etc/resolv.conf
resolv-file=/etc/dnsmasq-resolv.conf


# If you want dnsmasq to listen for DHCP and DNS requests only on
# specified interfaces (and the loopback) give the name of the
# interface (eg eth0) here.
# Repeat the line for more than one interface.
interface=lo
interface=eth0
interface=wlan0
interface=tun0

#Accept DNS queries only from hosts whose address is on a local subnet,
# ie a subnet for which an interface exists on the server.
# It is intended to be set as a default on installation, to allow unconfigured
# installations to be useful but also safe from being used for DNS amplification attacks.
local-service

# Set this (and domain: see below) if you want to have a domain
# automatically added to simple names in a hosts-file.
expand-hosts

# Set a different domain for a particular subnet
domain=silent.upri.box,192.168.55.0/24
{% if tor|bool %}
domain=ninja.upri.box,192.168.56.0/24
{% endif %}

# Set the cachesize here.
#cache-size=150

# For statistics purposes, log each DNS query as it passes through
# dnsmasq.
log-queries

# Localise the queries
localise-queries

# Include another lot of configuration options including the upribox blacklists.
#conf-file=/etc/dnsmasq.more.conf
conf-dir=/etc/dnsmasq.d

# Set the path for the dnsmasq logfile
log-facility={{default_settings.log.general.path}}/{{default_settings.log.dnsmasq.subdir}}/{{default_settings.log.dnsmasq.logfiles.logname}}

# set local ttl
local-ttl=120
